<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analisi dei dati per psicologi - 17&nbsp; Introduzione al calcolo delle probabilità</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/chapter_3/02_conditional_prob.html" rel="next">
<link href="../../chapters/chapter_2/06_causality.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/chapter_3/01_intro_prob.html">Probabilità</a></li><li class="breadcrumb-item"><a href="../../chapters/chapter_3/01_intro_prob.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduzione al calcolo delle probabilità</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Analisi dei dati per psicologi</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benvenuti</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/00_prelims.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/01_python_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Python (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/02_python_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/03_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/04_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pandas (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/05_pandas_aggregate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pandas (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/06_pandas_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas (3)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/07_matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Matplotlib</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_1/08_seaborn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Seaborn</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_2/00_scientific_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">La scienza dei dati e il metodo scientifico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_2/01_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_2/02_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_2/03_freq_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Distribuzioni di Frequenze</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_2/04_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Indici di posizione e di scala</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_2/05_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Le relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_2/06_causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_3/01_intro_prob.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduzione al calcolo delle probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_3/02_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_3/03_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_3/04a_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Inferenza Bayesiana</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_4/15_stan_beta_binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Linguaggio Stan</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Modelli lineari</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_5/05_03_reglin_bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Modello di regressione lineare bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_5/05_04_synt_sugar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_5/05_05_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Appendici</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a00_installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Ambiente di lavoro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a01_markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Jupyter Notebook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a02_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a03_colab_tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Colab: un breve tutorial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a04_virtual_env.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Ambienti virtuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a10_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Numeri binari, interi, razionali, irrazionali e reali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a13a_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Sigma algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter_7/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indice</h2>
   
  <ul>
  <li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">17.1</span> Introduzione</a></li>
  <li><a href="#storia-e-definizioni-della-probabilità" id="toc-storia-e-definizioni-della-probabilità" class="nav-link" data-scroll-target="#storia-e-definizioni-della-probabilità"><span class="header-section-number">17.2</span> Storia e definizioni della probabilità</a>
  <ul class="collapse">
  <li><a href="#che-cosè-la-probabilità" id="toc-che-cosè-la-probabilità" class="nav-link" data-scroll-target="#che-cosè-la-probabilità"><span class="header-section-number">17.2.1</span> Che cos’è la probabilità?</a></li>
  <li><a href="#storia-della-probabilità" id="toc-storia-della-probabilità" class="nav-link" data-scroll-target="#storia-della-probabilità"><span class="header-section-number">17.2.2</span> Storia della probabilità</a></li>
  <li><a href="#interpretazione-classica" id="toc-interpretazione-classica" class="nav-link" data-scroll-target="#interpretazione-classica"><span class="header-section-number">17.2.3</span> Interpretazione “classica”</a></li>
  <li><a href="#interpretazione-frequentista" id="toc-interpretazione-frequentista" class="nav-link" data-scroll-target="#interpretazione-frequentista"><span class="header-section-number">17.2.4</span> Interpretazione frequentista</a></li>
  <li><a href="#la-legge-dei-grandi-numeri" id="toc-la-legge-dei-grandi-numeri" class="nav-link" data-scroll-target="#la-legge-dei-grandi-numeri"><span class="header-section-number">17.2.5</span> La Legge dei Grandi Numeri</a></li>
  <li><a href="#collegamento-tra-probabilità-e-statistica" id="toc-collegamento-tra-probabilità-e-statistica" class="nav-link" data-scroll-target="#collegamento-tra-probabilità-e-statistica"><span class="header-section-number">17.2.6</span> Collegamento tra probabilità e statistica</a></li>
  <li><a href="#la-riscoperta-dei-metodi-monte-carlo-markov-chain" id="toc-la-riscoperta-dei-metodi-monte-carlo-markov-chain" class="nav-link" data-scroll-target="#la-riscoperta-dei-metodi-monte-carlo-markov-chain"><span class="header-section-number">17.2.7</span> La riscoperta dei metodi Monte Carlo Markov chain</a></li>
  <li><a href="#interpretazione-soggettivista" id="toc-interpretazione-soggettivista" class="nav-link" data-scroll-target="#interpretazione-soggettivista"><span class="header-section-number">17.2.8</span> Interpretazione soggettivista</a></li>
  <li><a href="#nota" id="toc-nota" class="nav-link" data-scroll-target="#nota"><span class="header-section-number">17.2.9</span> Nota</a></li>
  </ul></li>
  <li><a href="#definizioni-e-assiomi" id="toc-definizioni-e-assiomi" class="nav-link" data-scroll-target="#definizioni-e-assiomi"><span class="header-section-number">17.3</span> Definizioni e assiomi</a>
  <ul class="collapse">
  <li><a href="#esperimenti-casuali-ed-eventi" id="toc-esperimenti-casuali-ed-eventi" class="nav-link" data-scroll-target="#esperimenti-casuali-ed-eventi"><span class="header-section-number">17.3.1</span> Esperimenti casuali ed eventi</a></li>
  <li><a href="#spazi-campionari-ed-eventi" id="toc-spazi-campionari-ed-eventi" class="nav-link" data-scroll-target="#spazi-campionari-ed-eventi"><span class="header-section-number">17.3.2</span> Spazi Campionari ed Eventi</a></li>
  <li><a href="#probabilità" id="toc-probabilità" class="nav-link" data-scroll-target="#probabilità"><span class="header-section-number">17.3.3</span> Probabilità</a></li>
  <li><a href="#gli-assiomi-di-kolmogorov" id="toc-gli-assiomi-di-kolmogorov" class="nav-link" data-scroll-target="#gli-assiomi-di-kolmogorov"><span class="header-section-number">17.3.4</span> Gli Assiomi di Kolmogorov</a></li>
  </ul></li>
  <li><a href="#elementi-di-calcolo-combinatorio" id="toc-elementi-di-calcolo-combinatorio" class="nav-link" data-scroll-target="#elementi-di-calcolo-combinatorio"><span class="header-section-number">17.4</span> Elementi di calcolo combinatorio</a>
  <ul class="collapse">
  <li><a href="#permutazioni" id="toc-permutazioni" class="nav-link" data-scroll-target="#permutazioni"><span class="header-section-number">17.4.1</span> Permutazioni</a></li>
  <li><a href="#campionamento-con-e-senza-reinserimento" id="toc-campionamento-con-e-senza-reinserimento" class="nav-link" data-scroll-target="#campionamento-con-e-senza-reinserimento"><span class="header-section-number">17.4.2</span> Campionamento con e senza reinserimento</a></li>
  <li><a href="#combinazioni" id="toc-combinazioni" class="nav-link" data-scroll-target="#combinazioni"><span class="header-section-number">17.4.3</span> Combinazioni</a></li>
  </ul></li>
  <li><a href="#commenti-e-considerazioni-finali" id="toc-commenti-e-considerazioni-finali" class="nav-link" data-scroll-target="#commenti-e-considerazioni-finali"><span class="header-section-number">17.5</span> Commenti e considerazioni finali</a></li>
  <li><a href="#informazioni-sullambiente-di-sviluppo" id="toc-informazioni-sullambiente-di-sviluppo" class="nav-link" data-scroll-target="#informazioni-sullambiente-di-sviluppo"><span class="header-section-number">17.6</span> Informazioni sull’Ambiente di Sviluppo</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/ccaudek/psicometria/blob/main/chapters/chapter_3/01_intro_prob.ipynb" class="toc-action"><i class="bi bi-github"></i>Modifica questa pagina</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/chapter_3/01_intro_prob.html">Probabilità</a></li><li class="breadcrumb-item"><a href="../../chapters/chapter_3/01_intro_prob.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduzione al calcolo delle probabilità</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-intro-prob" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduzione al calcolo delle probabilità</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Prerequisiti</strong></p>
<p>Prima di procedere, è essenziale leggere l’appendice <a href="../chapter_7/a14_combinatorics.html" class="quarto-xref"><span>Appendice J</span></a> per ulteriori informazioni.</p>
<p><strong>Concetti e competenze chiave</strong></p>
<ul>
<li>Comprendere le diverse interpretazioni della probabilità.</li>
<li>Conoscere e saper applicare i concetti di spazio campionario ed evento.</li>
<li>Interpretare gli assiomi della probabilità.</li>
<li>Avere una chiara comprensione della legge dei grandi numeri.</li>
<li>Calcolare la probabilità tramite simulazione.</li>
<li>Applicare la legge dei grandi numeri tramite simulazione.</li>
<li>Calcolare le permutazioni e le combinazioni.</li>
</ul>
<p><strong>Preparazione del Notebook</strong></p>
<div id="cell-2" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> patches</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools <span class="im">as</span> it</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed to make the results fully reproducible</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>seed: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">map</span>(<span class="bu">ord</span>, <span class="st">"intro_prob"</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>rng: np.random.Generator <span class="op">=</span> np.random.default_rng(seed<span class="op">=</span>seed)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>az.style.use(<span class="st">"arviz-darkgrid"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">"figure.dpi"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">"figure.facecolor"</span>] <span class="op">=</span> <span class="st">"white"</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">"retina"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduzione" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="introduzione"><span class="header-section-number">17.1</span> Introduzione</h2>
<p>In questo capitolo, esamineremo alcuni concetti generali e fondamentali che sono cruciali per una comprensione dei metodi bayesiani. Ulteriori concetti legati alla probabilità verranno introdotti o approfonditi nei capitoli successivi, a seconda delle necessità. Tuttavia, per uno studio dettagliato della teoria delle probabilità, consiglio vivamente il libro “Introduction to Probability” di Blitzstein e Hwang (2019).</p>
<p>Nel corso di questo capitolo, esploreremo varie concezioni della probabilità, tra cui la visione classica, frequentista e bayesiana. Approfondiremo anche argomenti come le variabili casuali, le funzioni di massa di probabilità e le funzioni di ripartizione. Inoltre, introdurremo la simulazione con Python per una migliore comprensione della legge dei grandi numeri, un concetto fondamentale nell’ambito della probabilità.</p>
</section>
<section id="storia-e-definizioni-della-probabilità" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="storia-e-definizioni-della-probabilità"><span class="header-section-number">17.2</span> Storia e definizioni della probabilità</h2>
<p>La probabilità è un modo formale di quantificare l’incertezza, assegnando plausibilità o credibilità a un insieme di possibilità mutuamente esclusive o risultati di un esperimento o osservazione.</p>
<section id="che-cosè-la-probabilità" class="level3" data-number="17.2.1">
<h3 data-number="17.2.1" class="anchored" data-anchor-id="che-cosè-la-probabilità"><span class="header-section-number">17.2.1</span> Che cos’è la probabilità?</h3>
<p>Ci sono due modi principali per interpretare la probabilità:</p>
<ul>
<li><strong>Frequentista</strong>: Secondo il framework frequentista, la probabilità rappresenta il limite della frequenza relativa con cui un evento di interesse si verifica quando il numero di esperimenti condotti ripetutamente nelle stesse condizioni tende all’infinito. In questa visione, chiamata “ontologica”, la probabilità è considerata una proprietà intrinseca del mondo, indipendente dalla nostra esperienza. La probabilità è quindi vista come una caratteristica oggettiva della realtà.</li>
<li><strong>Bayesiana</strong>: Al contrario, il framework bayesiano interpreta la probabilità come una credenza soggettiva riguardo alla probabilità di accadimento di un evento. In questa prospettiva “epistemica”, la probabilità è una misura della nostra conoscenza del mondo piuttosto che una proprietà oggettiva. Questa visione soggettiva della probabilità dipende dalle informazioni disponibili e dal punto di vista dell’osservatore.</li>
</ul>
</section>
<section id="storia-della-probabilità" class="level3" data-number="17.2.2">
<h3 data-number="17.2.2" class="anchored" data-anchor-id="storia-della-probabilità"><span class="header-section-number">17.2.2</span> Storia della probabilità</h3>
<p>La storia della probabilità è lunga e complessa, come illustrato in varie opere (Tabak 2004, Stigler 1986, Weisberg 2014). L’origine della probabilità moderna risale a una domanda posta da Antoine Gombaud (Chevalier de Méré) a Blaise Pascal (1623–1662) su come dividere equamente le puntate di un gioco di carte interrotto.</p>
<section id="problema-dei-punti" class="level4" data-number="17.2.2.1">
<h4 data-number="17.2.2.1" class="anchored" data-anchor-id="problema-dei-punti"><span class="header-section-number">17.2.2.1</span> Problema dei punti</h4>
<p>Il problema può essere formulato così:</p>
<blockquote class="blockquote">
<p>Immaginiamo due persone che partecipano a un gioco a più round. In ogni round, entrambe le persone hanno la stessa probabilità di vincere. La prima persona che vince sei round consecutivi si aggiudicherà un ricco premio in denaro. Supponiamo che A e B abbiano già disputato sei round, con A che ha vinto cinque volte e B una volta. In quel momento, il gioco è interrotto. Poiché né A né B hanno raggiunto le sei vittorie, hanno deciso di dividere il premio. Ma qual è il modo più equo per farlo?</p>
</blockquote>
<p>La discussione tra Pierre de Fermat (1607–1665) e Pascal ha portato alla formalizzazione dell’utilizzo della matematica per risolvere questo problema, proponendo di considerare le probabilità di vincita di ciascun giocatore. Ad esempio, se A ha una probabilità del 97% di vincere il premio e B ha una probabilità del 3%, sembrerebbe equo assegnare ad A il 97% del premio. L’interesse pubblico per la loro corrispondenza è sopravvissuto grazie al libro di Christian Huygens del 1657 “De Ratiociniis in Ludo Aleae” (Sul Ragionamento nei Giochi di Dadi), che è rimasto il riferimento per la probabilità per circa 50 anni.</p>
</section>
<section id="sviluppi-successivi" class="level4" data-number="17.2.2.2">
<h4 data-number="17.2.2.2" class="anchored" data-anchor-id="sviluppi-successivi"><span class="header-section-number">17.2.2.2</span> Sviluppi successivi</h4>
<p>Il libro postumo di Jacob Bernoulli, “L’Arte della Congettura” (1713), ha segnato una svolta nella storia della probabilità. Bernoulli ha definito la probabilità come un indice di incertezza compreso tra 0 e 1 e ha collegato il calcolo della probabilità ai dati e alla frequenza a lungo termine di un evento, noto come legge dei grandi numeri. Bernoulli ha applicato la probabilità anche a settori diversi dal gioco d’azzardo, come la mortalità umana e la giustizia penale, creando la cosiddetta “probabilità soggettiva”.</p>
</section>
</section>
<section id="interpretazione-classica" class="level3" data-number="17.2.3">
<h3 data-number="17.2.3" class="anchored" data-anchor-id="interpretazione-classica"><span class="header-section-number">17.2.3</span> Interpretazione “classica”</h3>
<p>Storicamente, la prima definizione di probabilità è stata proposta da Pierre-Simon Laplace (1749-1827), che si è avvalso del calcolo combinatorio. Secondo Laplace, la probabilità<span class="math inline">\(P\)</span>di un evento è definita come il rapporto tra il numero di casi in cui l’evento si verifica e il numero totale di casi possibili. In questa definizione, un evento è qualcosa a cui è possibile assegnare un valore di verità, ovvero qualcosa che può essere vero o falso. Ad esempio, la probabilità di ottenere un 3 in un lancio di un singolo dado è 1/6 ≃ 0.17, poiché c’è un solo caso favorevole (il lancio ha prodotto un 3) su sei casi possibili (i numeri da 1 a 6). Tuttavia, questa definizione è insoddisfacente in quanto si basa sull’assunzione che ogni evento sia equiprobabile, il che non è sempre vero. Inoltre, questa definizione è circolare poiché per definire il concetto di probabilità, è necessario prima definire cosa significa che gli eventi siano equiprobabili, e quindi si deve già conoscere il concetto di probabilità.</p>
</section>
<section id="interpretazione-frequentista" class="level3" data-number="17.2.4">
<h3 data-number="17.2.4" class="anchored" data-anchor-id="interpretazione-frequentista"><span class="header-section-number">17.2.4</span> Interpretazione frequentista</h3>
<p>Un secondo tentativo di definire la probabilità (dopo quello “classico” di Laplace) si basa sull’approccio frequentista, che può essere attribuito a molti autori. In questo approccio, la probabilità è definita sulla base delle frequenze osservate dell’occorrenza di un evento. Questo approccio nasce dalla difficoltà di assegnare una probabilità agli eventi assumendo il principio di equiprobabilità, come nel caso delle monete, dei dadi o delle carte di un mazzo. Sebbene la probabilità di ottenere testa come risultato del lancio di un dado sia 1/2 se crediamo che la moneta sia bilanciata, se così non fosse non potremmo assegnare la stessa probabilità a tutti i risultati possibili. Tuttavia, possiamo stimare le probabilità come la frequenza<span class="math inline">\(f_t\)</span>, definita come il rapporto tra il numero di volte in cui un lancio ha prodotto “testa” e il numero totale di lanci.</p>
<p>Si osservi che l’osservazione della frequenza <span class="math inline">\(f_t\)</span> è solo un’ approssimazione della probabilità, ma l’accuratezza migliora all’aumentare del numero totale di lanci, <span class="math inline">\(N\)</span>. In linea di principio, la probabilità di ottenere “testa”, <span class="math inline">\(P(T)\)</span>, è il limite della frequenza <span class="math inline">\(f_t\)</span> quando il numero totale di lanci <span class="math inline">\(N\)</span> tende all’infinito. Tuttavia, questa definizione richiede l’infinita ripetizione di un esperimento, il che può essere impraticabile o impossibile in molti casi. Inoltre, questa definizione assume che gli eventi futuri siano simili agli eventi passati, il che non è sempre garantito.</p>
<div id="1c441907-d990-4347-bc5b-5d1babc16f64" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> coin_flips(n, run_label):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Genera un array di 0 e 1 dove 1 rappresenta 'testa' e 0 'croce'</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># usando una distribuzione binomiale.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    heads <span class="op">=</span> np.random.binomial(<span class="dv">1</span>, <span class="fl">0.5</span>, n)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcola la proporzione cumulativa di teste.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    flips <span class="op">=</span> np.arange(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    proportion_heads <span class="op">=</span> np.cumsum(heads) <span class="op">/</span> flips</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Crea un DataFrame per un facile accesso e visualizzazione dei dati.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame({<span class="st">'flips'</span>: flips, <span class="st">'proportion_heads'</span>: proportion_heads, <span class="st">'run'</span>: run_label})</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([coin_flips(n, <span class="ss">f'run</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.lineplot(data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'flips'</span>, y <span class="op">=</span> <span class="st">'proportion_heads'</span>, hue <span class="op">=</span> <span class="st">'run'</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_intro_prob_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="la-legge-dei-grandi-numeri" class="level3" data-number="17.2.5">
<h3 data-number="17.2.5" class="anchored" data-anchor-id="la-legge-dei-grandi-numeri"><span class="header-section-number">17.2.5</span> La Legge dei Grandi Numeri</h3>
<p>La simulazione precedente fornisce un esempio della Legge dei grandi numeri. La Legge dei Grandi Numeri afferma che, man mano che il numero di esperimenti casuali ripetuti aumenta, la stima della probabilità di un evento <span class="math inline">\(P(Y=y)\)</span> diventa sempre più accurata.</p>
<p>Il teorema sostiene che, con l’aumento del numero di ripetizioni di un esperimento casuale, la media dei risultati osservati tende a convergere al valore atteso teorico della variabile casuale. In altre parole, la media empirica dei risultati osservati si avvicina sempre di più al valore medio teorico.</p>
<p>Questa legge è cruciale perché garantisce che, con un numero sufficientemente grande di prove, la stima empirica della probabilità di un evento si avvicina al valore reale. Questo rende le stime probabilistiche più precise e affidabili.</p>
<p>Dal punto di vista pratico, la Legge dei Grandi Numeri consente di utilizzare modelli probabilistici per interpretare fenomeni reali. Anche se le osservazioni singole possono variare in modo casuale, la media delle osservazioni su un ampio numero di ripetizioni rifletterà fedelmente le probabilità teoriche.</p>
<p>Formalmente, data una serie di variabili casuali indipendenti <span class="math inline">\(X_1, X_2, \ldots, X_n\)</span>, ciascuna con media <span class="math inline">\(\mu\)</span>, la Legge dei Grandi Numeri è espressa come:</p>
<p><span class="math display">\[
\lim_{{n \to \infty}} P\left(\left|\frac{X_1 + X_2 + \ldots + X_n}{n} - \mu\right| &lt; \epsilon\right) = 1,
\]</span></p>
<p>dove <span class="math inline">\(\epsilon\)</span> è un valore positivo arbitrariamente piccolo e <span class="math inline">\(P(\cdot)\)</span> indica la probabilità. Questo significa che, con un numero molto grande di ripetizioni, la media campionaria osservata sarà vicina alla media teorica attesa, permettendo inferenze affidabili sulla probabilità degli eventi.</p>
<p>In sintesi, la Legge dei Grandi Numeri assicura che, aumentando il numero di prove, le stime empiriche delle probabilità diventano sempre più precise, allineandosi con i valori teorici attesi.</p>
<section id="problema-del-caso-singolo" class="level4" data-number="17.2.5.1">
<h4 data-number="17.2.5.1" class="anchored" data-anchor-id="problema-del-caso-singolo"><span class="header-section-number">17.2.5.1</span> Problema del caso singolo</h4>
<p>Nell’ambito dell’approccio frequentista alla probabilità, basato sulla concezione delle frequenze relative di eventi osservati su lunghe serie di ripetizioni, emerge un limite concettuale nel trattare la probabilità di eventi singolari e non ripetibili. Secondo questa prospettiva, infatti, non risulta rigorosamente appropriato discutere di probabilità relative a eventi unici e non replicabili nel tempo. Esempi emblematici di tali eventi includono la possibilità che Alcaraz vinca contro Djokovic nella finale di Wimbledon del 2023 o che si verifichi pioggia a Firenze il giorno di Ferragosto del 2024. Questi scenari, essendo unici e circoscritti a un preciso momento storico, sfuggono alla logica frequentista che richiede, per definizione, la possibilità di osservazione ripetuta degli eventi per valutarne la probabilità. Nonostante ciò, nel linguaggio comune non specialistico, è comune l’uso del termine “probabilità” per riferirsi anche a tali eventi specifici e non ripetibili, evidenziando così una discrepanza tra l’uso tecnico e quello colloquiale del concetto di probabilità.</p>
</section>
</section>
<section id="collegamento-tra-probabilità-e-statistica" class="level3" data-number="17.2.6">
<h3 data-number="17.2.6" class="anchored" data-anchor-id="collegamento-tra-probabilità-e-statistica"><span class="header-section-number">17.2.6</span> Collegamento tra probabilità e statistica</h3>
<p>Durante gli anni ’20 del Novecento, Ronald A. Fisher propose un nuovo framework teorico per l’inferenza statistica, basato sulla concettualizzazione della frequenza. Fisher introdusse concetti chiave come la massima verosimiglianza, i test di significatività, i metodi di campionamento, l’analisi della varianza e il disegno sperimentale.</p>
<p>Negli anni ’30, Jerzy Neyman ed Egon Pearson fecero ulteriori progressi nel campo con lo sviluppo di una teoria della decisione statistica, basata sul principio della verosimiglianza e sull’interpretazione frequentista della probabilità. Definirono due tipologie di errori decisionali e utilizzarono il test di significatività di Fisher, interpretando i valori<span class="math inline">\(p\)</span>come indicatori dei tassi di errore a lungo termine.</p>
</section>
<section id="la-riscoperta-dei-metodi-monte-carlo-markov-chain" class="level3" data-number="17.2.7">
<h3 data-number="17.2.7" class="anchored" data-anchor-id="la-riscoperta-dei-metodi-monte-carlo-markov-chain"><span class="header-section-number">17.2.7</span> La riscoperta dei metodi Monte Carlo Markov chain</h3>
<p>Fisher assunse una prospettiva critica nei confronti della “probabilità inversa” (ossia, i metodi bayesiani), nonostante questa fosse stata la metodologia predominante per l’inferenza statistica per quasi un secolo e mezzo. Il suo approccio frequentista ebbe un profondo impatto sullo sviluppo della statistica sia teorica che sperimentale, contribuendo a un decremento nell’utilizzo dell’inferenza basata sul metodo della probabilità inversa, originariamente proposto da Laplace.</p>
<p>Nel 1939, il libro di Harold Jeffreys intitolato “Theory of Probability” rappresentò una delle prime esposizioni moderne dei metodi bayesiani. Tuttavia, la rinascita del framework bayesiano fu rinviata fino alla scoperta dei metodi Monte Carlo Markov chain alla fine degli anni ’80. Questi metodi hanno reso fattibile il calcolo di risultati precedentemente non ottenibili, consentendo un rinnovato interesse e sviluppo nei metodi bayesiani. Per una storia dell’approccio bayesiano, si veda <a href="https://bayes.wustl.edu/etj/articles/general.background.pdf">Bayesian Methods: General Background</a> oppure <a href="https://plato.stanford.edu/entries/statistics/">Philosophy of Statistics</a>.</p>
</section>
<section id="interpretazione-soggettivista" class="level3" data-number="17.2.8">
<h3 data-number="17.2.8" class="anchored" data-anchor-id="interpretazione-soggettivista"><span class="header-section-number">17.2.8</span> Interpretazione soggettivista</h3>
<p>Una visione alternativa della probabilità la considera come una credenza soggettiva. <span class="citation" data-cites="de2017theory">De Finetti (<a href="../../99-references.html#ref-de2017theory" role="doc-biblioref">2017</a>)</span> ha proposto un’interpretazione in cui la probabilità non è vista come una caratteristica oggettiva degli eventi, ma piuttosto come una misura della credenza soggettiva, suggerendo di trattare <span class="math inline">\(p(·)\)</span> come una probabilità soggettiva. È interessante notare che de Finetti era un soggettivista radicale. Infatti, la frase di apertura del suo trattato in due volumi sulla probabilità afferma che “La probabilità non esiste”, intendendo che la probabilità non ha uno status oggettivo, ma rappresenta piuttosto la quantificazione della nostra esperienza di incertezza. Riteneva che l’idea di una probabilità esterna all’individuo, con uno status oggettivo, fosse pura superstizione, paragonabile al credere in “Etere cosmico, Spazio e Tempo assoluti, …, o Fate e Streghe…”. Secondo de Finetti, “… esistono solo probabilità soggettive - cioè, il grado di credenza nell’occorrenza di un evento attribuito da una determinata persona in un dato momento con un dato insieme di informazioni.”</p>
<p>Come sottolineato da <span class="citation" data-cites="press2009subjective">Press (<a href="../../99-references.html#ref-press2009subjective" role="doc-biblioref">2009</a>)</span>, la prima menzione della probabilità come grado di credenza soggettiva fu fatta da <span class="citation" data-cites="ramsey1926truth">Ramsey (<a href="../../99-references.html#ref-ramsey1926truth" role="doc-biblioref">1926</a>)</span>, ed è questa nozione di probabilità come credenza soggettiva che ha portato a una notevole resistenza alle idee bayesiane. Una trattazione dettagliata degli assiomi della probabilità soggettiva si trova in <span class="citation" data-cites="fishburn1986axioms">Fishburn (<a href="../../99-references.html#ref-fishburn1986axioms" role="doc-biblioref">1986</a>)</span>.</p>
<p>La denominazione “soggettivo” legata alla probabilità potrebbe risultare infelice, poiché potrebbe suggerire un ragionamento vago o non scientifico. <span class="citation" data-cites="lindley2013understanding">Lindley (<a href="../../99-references.html#ref-lindley2013understanding" role="doc-biblioref">2013</a>)</span> condivide queste riserve, proponendo l’alternativa “probabilità personale” rispetto a “probabilità soggettiva”. Analogamente, <span class="citation" data-cites="howson2006scientific">Howson e Urbach (<a href="../../99-references.html#ref-howson2006scientific" role="doc-biblioref">2006</a>)</span> preferiscono utilizzare l’espressione “probabilità epistemica”, che riflette il grado di incertezza di un individuo di fronte al problema trattato. In sostanza, la probabilità epistemica si riferisce all’incertezza personale riguardo a variabili sconosciute. Questa terminologia viene adottata anche nel testo di <span class="citation" data-cites="kaplan2023bayesian">Kaplan (<a href="../../99-references.html#ref-kaplan2023bayesian" role="doc-biblioref">2023</a>)</span>, fornendo un linguaggio più neutro per discutere di questi concetti.</p>
<p>Va inoltre notato che l’interpretazione soggettiva si adatta bene a eventi singoli, permettendo di esprimere una convinzione su eventi specifici, come la probabilità di pioggia in un dato giorno o l’esito di una competizione sportiva.</p>
</section>
<section id="nota" class="level3" data-number="17.2.9">
<h3 data-number="17.2.9" class="anchored" data-anchor-id="nota"><span class="header-section-number">17.2.9</span> Nota</h3>
<p>Per chi desidera approfondire, il primo capitolo del testo <em>Bernoulli’s Fallacy</em> <span class="citation" data-cites="clayton2021bernoulli">(<a href="../../99-references.html#ref-clayton2021bernoulli" role="doc-biblioref">Clayton 2021</a>)</span> offre un’introduzione molto leggibile alle tematiche della definizione della probabilità nella storia della scienza.</p>
</section>
</section>
<section id="definizioni-e-assiomi" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="definizioni-e-assiomi"><span class="header-section-number">17.3</span> Definizioni e assiomi</h2>
<p>Indipendentemente dalla controversia in corso sulla sua interpretazione, la probabilità è stata stabilita come teoria matematica dal matematico sovietico Andrey Kolmogorov all’inizio del XX secolo. Poiché sia i frequentisti che i bayesiani utilizzano questa teoria matematica, il disaccordo riguarda l’interpretazione e non la matematica.</p>
<p>È possibile definire la probabilità utilizzando i seguenti tre concetti: esperimento, spazio campionario ed evento.</p>
<section id="esperimenti-casuali-ed-eventi" class="level3" data-number="17.3.1">
<h3 data-number="17.3.1" class="anchored" data-anchor-id="esperimenti-casuali-ed-eventi"><span class="header-section-number">17.3.1</span> Esperimenti casuali ed eventi</h3>
<p>Sia i fenomeni deterministici che quelli stocastici influenzano la nostra vita quotidiana, determinando le dinamiche degli eventi che ci circondano.</p>
<ul>
<li>Un <strong>fenomeno deterministico</strong> produce sempre lo stesso risultato ogni volta che viene ripetuto nelle stesse condizioni. Ad esempio, se riscaldiamo l’acqua a 100°C a livello del mare, essa bollirà sempre.</li>
<li>Un <strong>fenomeno casuale</strong> è caratterizzato da condizioni in cui il risultato non può essere determinato con certezza prima che si verifichi. In altre parole, ogni volta che il processo o l’esperimento viene ripetuto, si osserva uno tra i vari possibili risultati. Ad esempio, quando si lancia una moneta, l’esito può essere testa (T) o croce (C), ma non si può conoscere in anticipo quale sarà.</li>
</ul>
<p>Nella teoria delle probabilità, un <em>esperimento casuale</em> è un processo o una situazione in cui il risultato non può essere previsto con certezza prima dell’esecuzione dell’esperimento. Per poter analizzare correttamente gli esperimenti casuali, sono fondamentali alcune nozioni chiave, come indicato nelle sezioni successive.</p>
</section>
<section id="spazi-campionari-ed-eventi" class="level3" data-number="17.3.2">
<h3 data-number="17.3.2" class="anchored" data-anchor-id="spazi-campionari-ed-eventi"><span class="header-section-number">17.3.2</span> Spazi Campionari ed Eventi</h3>
<p>Lo <strong>spazio campionario</strong> <span class="math inline">\(\Omega\)</span> è l’insieme degli esiti possibili di un esperimento. I punti<span class="math inline">\(\omega\)</span>in<span class="math inline">\(\Omega\)</span>sono chiamati <strong>esiti campionari</strong> o <strong>realizzazioni</strong>.</p>
<p>Ad esempio, se lanciamo un dado a 6 facce, lo spazio campionario è costituito dai sei possibili risultati, Ω = {1, 2, 3, 4, 5, 6}. Diversi esperimenti casuali hanno spazi campionari differenti che possono essere rappresentati in modo equivalente. Ad esempio:</p>
<ul>
<li>Lancio di una moneta: Ω = {T, C}</li>
<li>Lancio di due monete: Ω = {TT, TC, CT, CC}</li>
</ul>
<p>Gli <strong>eventi</strong> sono sottoinsiemi di<span class="math inline">\(\Omega\)</span>.</p>
<p>Un evento è denotato da una lettera maiuscola come A, B, o C. Ad esempio, nel caso del lancio di un dado, l’evento “numero pari” può essere rappresentato da A = {2, 4, 6}, che è un sottoinsieme di Ω (A ⊂ Ω), e l’evento “numero dispari” da B = {1, 3, 5}, anch’esso un sottoinsieme di Ω (B ⊂ Ω).</p>
<p>Se un evento è costituito da un singolo risultato dello spazio campionario, è detto evento elementare. Ad esempio, l’evento di ottenere il numero 1 nel lancio di un dado, denotato come A = {1}. Se un evento è costituito da più risultati dello spazio campionario, è detto evento composto, come l’evento di ottenere un numero pari nel lancio di un dado, A = {2, 4, 6}.</p>
<p>Dato un evento<span class="math inline">\(A\)</span>, sia <span class="math inline">\(A^c = \{ \omega \in \Omega : \text{non } (\omega \in A) \}\)</span> il complemento di <span class="math inline">\(A\)</span>. Il complemento di<span class="math inline">\(\Omega\)</span>è l’insieme vuoto <span class="math inline">\(\varnothing\)</span>.</p>
<p>L’unione degli eventi<span class="math inline">\(A\)</span>e<span class="math inline">\(B\)</span>è definita come <span class="math inline">\(A \cup B = \{ \omega \in \Omega : \omega \in A \text{ o } \omega \in B \}\)</span>. Se<span class="math inline">\(A_1, A_2, \dots\)</span>è una sequenza di insiemi, allora</p>
<p><span class="math display">\[\cup_{i=1}^\infty A_i = \left\{ \omega \in \Omega : \omega \in A_i \text{ per qualche } i \right\}\]</span></p>
<p>L’intersezione di <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> è <span class="math inline">\(A \cap B = \{ \omega \in \Omega : \omega \in A \text{ e } \omega \in B \}\)</span>. Se <span class="math inline">\(A_1, A_2, \dots\)</span> è una sequenza di insiemi, allora</p>
<p><span class="math display">\[\cap_{i=1}^\infty A_i = \left\{ \omega \in \Omega : \omega \in A_i \text{ per tutti } i \right\}\]</span></p>
<p>Sia <span class="math inline">\(A - B = \left\{ \omega \in \Omega : \omega \in A \text{ e non } (\omega \in B) \right\}\)</span>. Se ogni elemento di <span class="math inline">\(A\)</span> è contenuto in <span class="math inline">\(B\)</span>, scriviamo <span class="math inline">\(A \subset B\)</span>o<span class="math inline">\(B \supset A\)</span>. Se <span class="math inline">\(A\)</span> è un insieme finito, sia <span class="math inline">\(|A|\)</span> il numero di elementi in <span class="math inline">\(A\)</span>.</p>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Notazione</th>
<th>Significato</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\Omega\)</span></td>
<td>spazio campionario</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\omega\)</span></td>
<td>esito</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A\)</span></td>
<td>evento (sottoinsieme di<span class="math inline">\(\Omega\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\vert A \vert\)</span></td>
<td>numero di elementi in<span class="math inline">\(A\)</span>(se finito)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A^c\)</span></td>
<td>complemento di<span class="math inline">\(A\)</span>(non<span class="math inline">\(A\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(A \cup B\)</span></td>
<td>unione (<span class="math inline">\(A\)</span>o<span class="math inline">\(B\)</span>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A \cap B\)</span>o<span class="math inline">\(AB\)</span></td>
<td>intersezione (<span class="math inline">\(A\)</span>e<span class="math inline">\(B\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(A - B\)</span></td>
<td>differenza insiemistica (punti in<span class="math inline">\(A\)</span>ma non in<span class="math inline">\(B\)</span>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A \subset B\)</span></td>
<td>inclusione insiemistica (<span class="math inline">\(A\)</span>è un sottoinsieme di<span class="math inline">\(B\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\varnothing\)</span></td>
<td>evento nullo (sempre falso)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\Omega\)</span></td>
<td>evento certo (sempre vero)</td>
</tr>
</tbody>
</table>
<p>Diciamo che<span class="math inline">\(A_1, A_2, \dots\)</span>sono <strong>disgiunti</strong> o <strong>mutuamente esclusivi</strong> se<span class="math inline">\(A_i \cap A_j = \varnothing\)</span>ogni volta che<span class="math inline">\(i \neq j\)</span>.</p>
<p>Una <strong>partizione</strong> di<span class="math inline">\(\Omega\)</span>è una sequenza di insiemi disgiunti<span class="math inline">\(A_1, A_2, \dots\)</span>tale che<span class="math inline">\(\cup_{i=1}^\infty A_i = \Omega\)</span>.</p>
<p>Dato un evento<span class="math inline">\(A\)</span>, definiamo la <strong>funzione indicatrice di<span class="math inline">\(A\)</span></strong> come</p>
<p><span class="math display">\[I_A(\omega) = I(\omega \in A) = \begin{cases}
1 &amp;\text{se } \omega \in A \\
0 &amp;\text{altrimenti}
\end{cases}
\]</span></p>
<p>Una sequenza di insiemi <span class="math inline">\(A_1, A_2, \dots\)</span> è <strong>monotona crescente</strong> se <span class="math inline">\(A_1 \subset A_2 \subset \dots\)</span>, e definiamo <span class="math inline">\(\lim_{n \rightarrow \infty} A_n = \cup_{i=1}^\infty A_i\)</span>. Una sequenza di insiemi <span class="math inline">\(A_1, A_2, \dots\)</span> è <strong>monotona decrescente</strong> se <span class="math inline">\(A_1 \supset A_2 \supset \dots\)</span> e allora definiamo <span class="math inline">\(\lim_{n \rightarrow \infty} A_n = \cap_{i=1}^n A_i\)</span>. In entrambi i casi, scriveremo <span class="math inline">\(A_n \rightarrow A\)</span>.</p>
</section>
<section id="probabilità" class="level3" data-number="17.3.3">
<h3 data-number="17.3.3" class="anchored" data-anchor-id="probabilità"><span class="header-section-number">17.3.3</span> Probabilità</h3>
<p>La probabilità di un evento è una misura numerica che indica la possibilità che tale evento si verifichi. Nel caso del lancio di una moneta, la probabilità di ottenere testa è 1/2, così come la probabilità di ottenere croce. I valori di probabilità P(A) = 0 rappresentano eventi impossibili, mentre P(A) = 1 rappresentano eventi certi.</p>
<p>Per denotare la probabilità che un evento A non si verifichi, possiamo usare la notazione P(¬A) o P(A̅), dove P(A̅) = 1 - P(A).</p>
</section>
<section id="gli-assiomi-di-kolmogorov" class="level3" data-number="17.3.4">
<h3 data-number="17.3.4" class="anchored" data-anchor-id="gli-assiomi-di-kolmogorov"><span class="header-section-number">17.3.4</span> Gli Assiomi di Kolmogorov</h3>
<p>Una funzione <span class="math inline">\(\mathbb{P}\)</span> che assegna un numero reale <span class="math inline">\(\mathbb{P}(A)\)</span> a ogni evento <span class="math inline">\(A\)</span> è una <strong>distribuzione di probabilità</strong> o una <strong>misura di probabilità</strong> se soddisfa i seguenti tre assiomi:</p>
<ul>
<li><strong>Assioma 1</strong>. La probabilità di un evento <span class="math inline">\(A\)</span> è un numero non negativo: <span class="math inline">\(\mathbb{P}(A) \geq 0\)</span> per ogni <span class="math inline">\(A\)</span>.</li>
<li><strong>Assioma 2</strong>. La probabilità di tutti i possibili esiti, o spazio campionario <span class="math inline">\(\Omega\)</span>, è pari a uno: <span class="math inline">\(\mathbb{P}(\Omega) = 1\)</span>.</li>
<li><strong>Assioma 3</strong>. Se <span class="math inline">\(A_1, A_2, \dots\)</span> sono disgiunti (mutuamente esclusivi) allora</li>
</ul>
<p><span class="math display">\[\mathbb{P} \left( \cup_{i=1}^\infty A_i \right) = \sum_{i=1}^\infty \mathbb{P}(A_i).\]</span></p>
<p>I primi due assiomi insieme implicano che la probabilità varia da 0 a 1. Per comprendere l’ultimo assioma, consideriamo il concetto di eventi mutuamente esclusivi, ossia due eventi, <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span>, che non condividono alcun risultato. In questo caso, possiamo applicare la regola dell’addizione per concludere che <span class="math inline">\(P(A \cup B) = P(A) + P(B)\)</span>.</p>
<div id="0965bc82-16f4-4174-9ba1-ec9d38471cf2" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creare una nuova figura</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creare cerchi per A e B</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>circle_A <span class="op">=</span> patches.Circle((<span class="fl">0.3</span>, <span class="fl">0.5</span>), <span class="fl">0.2</span>, edgecolor<span class="op">=</span><span class="st">'blue'</span>, facecolor<span class="op">=</span><span class="st">'lightblue'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>circle_B <span class="op">=</span> patches.Circle((<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="fl">0.2</span>, edgecolor<span class="op">=</span><span class="st">'blue'</span>, facecolor<span class="op">=</span><span class="st">'lightblue'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggiungere cerchi alla trama</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>ax.add_patch(circle_A)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ax.add_patch(circle_B)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggiungere etichette per A, B e le regioni</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="st">'A'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="st">'B'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="st">'A ∩ B'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="st">'A ∩ B^c'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="st">'B ∩ A^c'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Impostare i limiti dell'asse</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Rimuovere assi</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">'off'</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrare la trama</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_intro_prob_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ora, consideriamo due eventi che non sono mutuamente esclusivi perché condividono un risultato. In questo caso, la regola dell’addizione non si applica perché sia <span class="math inline">\(A\)</span> che <span class="math inline">\(B\)</span> contengono alcuni stessi risultati. Per eventi che non sono mutuamente esclusivi, possiamo applicare la seguente regola generale dell’addizione:</p>
<p>Per qualsiasi evento dato<span class="math inline">\(A\)</span>e<span class="math inline">\(B\)</span>, la regola dell’addizione è data da:</p>
<p><span class="math display">\[P(A \cup B) = P(A) + P(B) - P(A \cap B).\]</span></p>
<p>Usando il terzo assioma della probabilità, abbiamo:</p>
<p><span class="math display">\[P(A \cup B) = P(A \cap B^c) + P(B \cap A^c) + P(A \cap B).\]</span></p>
<p>Quando <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> sono mutuamente esclusivi, <span class="math inline">\(P(A \cap B^c)\)</span> e <span class="math inline">\(P(B \cap A^c)\)</span> si riducono a <span class="math inline">\(P(A)\)</span> e <span class="math inline">\(P(B)\)</span> rispettivamente. Inoltre, abbiamo <span class="math inline">\(P(A \cap B) = 0\)</span> in questo caso di mutua esclusività.</p>
<p>Infine, notiamo che l’evento <span class="math inline">\(A\)</span> può essere scomposto in due eventi mutuamente esclusivi, <span class="math inline">\({A \cap B}\)</span> (regione sovrapposta) e <span class="math inline">\({A \cap B^c}\)</span> (regione non sovrapposta). Questo è chiamato legge della probabilità totale. Per qualsiasi evento dato <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span>, la legge della probabilità totale è data da:</p>
<p><span class="math display">\[P(A) = P(A \cap B) + P(A \cap B^c).\]</span></p>
<p>Secondo la legge della probabilità totale, possiamo scrivere <span class="math inline">\(P(A \cap B^c) = P(A) - P(A \cap B)\)</span> sottraendo <span class="math inline">\(P(A \cap B)\)</span> da entrambi i lati dell’equazione. Analogamente, la legge della probabilità totale può essere applicata all’evento <span class="math inline">\(B\)</span>, ottenendo <span class="math inline">\(P(B \cap A^c) = P(B) - P(A \cap B)\)</span>. Sostituendo questi risultati nell’equazione precedente e semplificando l’espressione, si arriva alla regola generale dell’addizione. Sottolineiamo che questo risultato è ottenuto utilizzando solo gli assiomi della probabilità.</p>
<p>Alcune proprietà che possono essere derivate dagli assiomi:</p>
<ul>
<li><span class="math inline">\(\mathbb{P}(\varnothing) = 0\)</span>,</li>
<li><span class="math inline">\(A \subset B \Rightarrow \mathbb{P}(A) \leq \mathbb{P}(B)\)</span>,</li>
<li><span class="math inline">\(0 \leq \mathbb{P}(A) \leq 1\)</span>,</li>
<li><span class="math inline">\(\mathbb{P}\left(A^c\right) = 1 - \mathbb{P}(A)\)</span>,</li>
<li><span class="math inline">\(A \cap B = \varnothing \Rightarrow \mathbb{P}(A \cup B) = \mathbb{P}(A) + \mathbb{P}(B)\)</span>.</li>
</ul>
</section>
</section>
<section id="elementi-di-calcolo-combinatorio" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="elementi-di-calcolo-combinatorio"><span class="header-section-number">17.4</span> Elementi di calcolo combinatorio</h2>
<section id="permutazioni" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="permutazioni"><span class="header-section-number">17.4.1</span> Permutazioni</h3>
<p>Quando ogni risultato è ugualmente probabile, per calcolare la probabilità di un evento <span class="math inline">\(A\)</span>, è necessario contare il numero di elementi nell’evento <span class="math inline">\(A\)</span> e il numero totale di elementi nello spazio campionario:</p>
<p><span class="math display">\[\mathbb{P}(A) = \frac{|A|}{|\Omega|}.\]</span></p>
<p>Ora introduciamo una tecnica di conteggio utile, chiamata permutazioni. Le permutazioni si riferiscono al numero di modi in cui gli oggetti possono essere disposti. Ad esempio, consideriamo tre oggetti distinti A, B e C. Ci sono 6 modi diversi per disporli: {ABC, ACB, BAC, BCA, CAB, CBA}.</p>
<p>Come possiamo calcolare il numero di permutazioni senza enumerare ogni disposizione, specialmente quando il numero di oggetti è grande? C’è un modo semplice per farlo. Consideriamo l’esempio di disporre tre oggetti, A, B e C. Prima di tutto, ci sono tre modi per scegliere il primo oggetto: A, B o C. Una volta scelto il primo oggetto, ci sono due modi per scegliere il secondo oggetto. Infine, rimane un solo modo per scegliere l’ultimo oggetto. Possiamo concettualizzare questo processo come un albero, dove il numero totale di foglie è uguale al numero di permutazioni. Per calcolare il numero di foglie, basta moltiplicare sequenzialmente il numero di rami a ogni livello, cioè <span class="math inline">\(3 \times 2 \times 1\)</span>.</p>
<p>Generalizzando questa idea, possiamo calcolare il numero di permutazioni di<span class="math inline">\(k\)</span>oggetti su un insieme di <span class="math inline">\(n\)</span> oggetti unici, denotato da <span class="math inline">\(nPk\)</span> dove<span class="math inline">\(k \leq n\)</span>, usando la seguente formula:</p>
<p>Il numero di permutazioni di<span class="math inline">\(k\)</span>oggetti su<span class="math inline">\(n\)</span>oggetti unici è dato da:</p>
<p><span class="math display">\[nPk = \frac{n!}{(n - k)!}.\]</span></p>
<p>Un fattoriale è definito come:</p>
<p><span class="math display">\[n! = n \times (n - 1) \times \cdots \times 2 \times 1.\]</span></p>
<p>Si noti che <span class="math inline">\(0!\)</span> è definito come 1.</p>
<section id="problema-dei-compleanni" class="level4" data-number="17.4.1.1">
<h4 data-number="17.4.1.1" class="anchored" data-anchor-id="problema-dei-compleanni"><span class="header-section-number">17.4.1.1</span> Problema dei Compleanni</h4>
<p>Il problema dei compleanni è un noto esempio controintuitivo di permutazioni. Il problema chiede quanti individui sono necessari affinché la probabilità che almeno due persone abbiano lo stesso compleanno superi 0.5, assumendo che ogni compleanno sia ugualmente probabile. Sorprendentemente, la risposta è solo 23 persone, molto meno di quanto la maggior parte delle persone immagina.</p>
<p>Per risolvere questo problema usando le permutazioni, notiamo la seguente relazione:</p>
<p><span class="math display">\[P(\text{almeno due persone hanno lo stesso compleanno}) = 1 - P(\text{nessuno ha lo stesso compleanno}).\]</span></p>
<p>Questa uguaglianza vale perché l’evento “nessuno ha lo stesso compleanno” è il complemento dell’evento “almeno due persone hanno lo stesso compleanno”. Questo significa che dobbiamo solo calcolare la probabilità che nessuno abbia lo stesso compleanno.</p>
<p>Sia <span class="math inline">\(k\)</span> il numero di persone. Per calcolare la probabilità che nessuno abbia lo stesso compleanno, contiamo il numero di modi in cui <span class="math inline">\(k\)</span> persone possono avere compleanni diversi. Poiché ogni compleanno è ugualmente probabile, possiamo usare le permutazioni per contare il numero di modi in cui <span class="math inline">\(k\)</span> compleanni unici possono essere disposti su 365 giorni:</p>
<p><span class="math display">\[365Pk = \frac{365!}{(365 - k)!}.\]</span></p>
<p>Dividiamo questo numero per il numero totale di elementi nello spazio campionario, che è il numero totale di modi in cui <span class="math inline">\(k\)</span> compleanni non unici possono essere disposti su 365 giorni:</p>
<p><span class="math display">\[365^k .\]</span></p>
<p>Quindi, abbiamo:</p>
<p><span class="math display">\[P(\text{nessuno ha lo stesso compleanno}) = \frac{365Pk}{365^k} = \frac{365!}{365^k (365 - k)!} .\]</span></p>
<p>Insieme alla precedente equazione, la soluzione al problema dei compleanni è:</p>
<p><span class="math display">\[1 - \frac{365!}{365^k (365 - k)!} .\]</span></p>
<div id="8f1a6709-5724-489a-8c83-d5f67cc92ae8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> birthday(k):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    logdenom <span class="op">=</span> k <span class="op">*</span> math.log(<span class="dv">365</span>) <span class="op">+</span> math.lgamma(<span class="dv">365</span> <span class="op">-</span> k <span class="op">+</span> <span class="dv">1</span>) <span class="co"># log denominatore</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    lognumer <span class="op">=</span> math.lgamma(<span class="dv">366</span>) <span class="co"># log numeratore</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    pr <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> np.exp(lognumer <span class="op">-</span> logdenom) <span class="co"># trasformazione inversa</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pr</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">51</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>bday <span class="op">=</span> [birthday(i) <span class="cf">for</span> i <span class="kw">in</span> k]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>plt.plot(k, bday, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Numero di persone'</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Probabilità che almeno due persone</span><span class="ch">\n</span><span class="st">abbiano lo stesso compleanno'</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Probabilità del Problema dei Compleanni'</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Probabilità per 20-25 persone:"</span>, bday[<span class="dv">19</span>:<span class="dv">25</span>])</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_intro_prob_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Probabilità per 20-25 persone: [0.41143838358049944, 0.44368833516523465, 0.47569530766240553, 0.507297234324024, 0.5383442579144757, 0.5686997039694264]</code></pre>
</div>
</div>
<p>Osserviamo che quando il numero di persone è 23, la probabilità che almeno due persone abbiano lo stesso compleanno supera 0.5. Quando il numero di persone è più di 50, questa probabilità è quasi 1.</p>
</section>
</section>
<section id="campionamento-con-e-senza-reinserimento" class="level3" data-number="17.4.2">
<h3 data-number="17.4.2" class="anchored" data-anchor-id="campionamento-con-e-senza-reinserimento"><span class="header-section-number">17.4.2</span> Campionamento con e senza reinserimento</h3>
<p>Abbiamo derivato una soluzione analitica esatta per il problema dei compleanni, ma possiamo anche produrre una soluzione approssimata utilizzando il metodo della simulazione Monte Carlo. Il nome deriva dal Casinò di Monte Carlo a Monaco, ma possiamo semplicemente chiamarlo metodo di simulazione. La simulazione Monte Carlo è una classe generale di metodi stocastici (contrariamente ai metodi deterministici) che possono essere utilizzati per risolvere approssimativamente problemi analitici generando casualmente le quantità di interesse.</p>
<p>Per il problema dei compleanni, campioniamo<span class="math inline">\(k\)</span>compleanni potenzialmente non unici su 365 giorni e verifichiamo se i<span class="math inline">\(k\)</span> compleanni campionati sono tutti diversi. Utilizziamo il campionamento con reinserimento perché ad ogni estrazione ogni giorno dei 365 è ugualmente probabile, indipendentemente dai giorni estratti in precedenza. In altre parole, il fatto che una persona sia nata in un certo giorno dell’anno non esclude che qualcun altro possa essere nato lo stesso giorno. Dopo aver ripetuto questa procedura di campionamento molte volte, calcoliamo la frazione di prove di simulazione in cui almeno due compleanni sono uguali, e questa frazione serve come stima della probabilità corrispondente. Questa procedura di simulazione è intuitiva perché emula il processo di generazione dei dati descritto nel problema dei compleanni.</p>
<p>Per implementare il campionamento con o senza reinserimento in Python, utilizziamo la funzione <code>numpy.random.choice</code>. Nel caso del campionamento con reinserimento, impostiamo l’argomento <code>replace</code> su <code>True</code>. Il campionamento senza reinserimento significa che, una volta campionato un elemento, questo non sarà disponibile per estrazioni successive.</p>
<div id="467440e0-d8d4-47e7-9ce5-cd7be24292ab" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">23</span>  <span class="co"># numero di persone</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sims <span class="op">=</span> <span class="dv">1000</span>  <span class="co"># numero di simulazioni</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>event <span class="op">=</span> <span class="dv">0</span>  <span class="co"># contatore eventi</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(sims):</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    days <span class="op">=</span> np.random.choice(<span class="dv">365</span>, k, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    unique_days <span class="op">=</span> np.unique(days)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(unique_days) <span class="op">&lt;</span> k:</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        event <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># frazione di prove in cui almeno due compleanni sono uguali</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>answer <span class="op">=</span> event <span class="op">/</span> sims</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Stima della probabilità: </span><span class="sc">{</span>answer<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Aumentare il numero di simulazioni a un milione per maggiore accuratezza</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>sims_large <span class="op">=</span> <span class="dv">1000000</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>event_large <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(sims_large):</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    days <span class="op">=</span> np.random.choice(<span class="dv">365</span>, k, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    unique_days <span class="op">=</span> np.unique(days)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(unique_days) <span class="op">&lt;</span> k:</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        event_large <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>answer_large <span class="op">=</span> event_large <span class="op">/</span> sims_large</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Stima con un milione di simulazioni: </span><span class="sc">{</span>answer_large<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stima della probabilità: 0.509
Stima con un milione di simulazioni: 0.506191</code></pre>
</div>
</div>
<p>Nel codice sopra, abbiamo impostato il numero di simulazioni a 1000. Aumentando il numero di simulazioni a un milione, otteniamo una stima più accurata. Osserviamo che quando il numero di persone è 23, la probabilità che almeno due persone abbiano lo stesso compleanno è superiore a 0.5. Quando il numero di persone supera 50, questa probabilità è vicina a 1.</p>
<p>La simulazione Monte Carlo è una classe generale di procedure di campionamento casuale ripetuto utilizzate per risolvere approssimativamente problemi analitici. I metodi comunemente utilizzati includono il campionamento con reinserimento, in cui la stessa unità può essere campionata ripetutamente, e il campionamento senza reinserimento, in cui ogni unità può essere campionata al massimo una volta.</p>
</section>
<section id="combinazioni" class="level3" data-number="17.4.3">
<h3 data-number="17.4.3" class="anchored" data-anchor-id="combinazioni"><span class="header-section-number">17.4.3</span> Combinazioni</h3>
<p>Introduciamo un’altra utile tecnica di conteggio chiamata combinazioni. Le combinazioni sono simili alle permutazioni, ma ignorano l’ordine degli elementi. In altre parole, le combinazioni rappresentano i modi di scegliere <span class="math inline">\(k\)</span> elementi distinti da<span class="math inline">\(n\)</span>elementi senza considerare l’ordine. Ad esempio, scegliendo 2 elementi da 3 (A, B e C), le permutazioni sono 6 (AB, BA, AC, CA, BC, CB), mentre le combinazioni sono 3 (AB, AC, BC).</p>
<p>Per calcolare le combinazioni, prima calcoliamo le permutazioni<span class="math inline">\(nPk\)</span>e poi dividiamo per <span class="math inline">\(k!\)</span>. Questo perché ci sono <span class="math inline">\(k!\)</span> modi per disporre <span class="math inline">\(k\)</span> elementi in ordine diverso, ma tutte queste disposizioni contano come una singola combinazione. La formula generale per le combinazioni è:</p>
<p><span class="math display">\[
nCk = \frac{n!}{k!(n-k)!} .
\]</span></p>
<section id="esempio-problema-di-una-commissione-psicologica" class="level4" data-number="17.4.3.1">
<h4 data-number="17.4.3.1" class="anchored" data-anchor-id="esempio-problema-di-una-commissione-psicologica"><span class="header-section-number">17.4.3.1</span> Esempio: Problema di una Commissione Psicologica</h4>
<p>Supponiamo di dover formare una commissione di 5 psicologi su un gruppo di 20 persone (10 psicologi clinici e 10 psicologi del lavoro). Qual è la probabilità che almeno 2 psicologi clinici siano nella commissione? Per calcolare questa probabilità, notiamo prima la seguente uguaglianza:</p>
<p><span class="math display">\[
P(\text{almeno 2 psicologi clinici}) = 1 - P(\text{nessun psicologo clinico}) - P(\text{esattamente 1 psicologo clinico}).
\]</span></p>
<p>Il numero totale di modi per selezionare 5 persone dalla commissione su 20 è dato da:</p>
<p><span class="math display">\[
20C5 = \frac{20!}{5!(15!)} = 15,504 .
\]</span></p>
<p>Il numero di modi per avere nessun psicologo clinico nella commissione è:</p>
<p><span class="math display">\[
10C0 \times 10C5 = 1 \times 252 = 252 .
\]</span></p>
<p>Quindi, la probabilità di avere nessun psicologo clinico è <span class="math inline">\(\frac{252}{15,504} \approx 0.016\)</span>.</p>
<p>Il numero di modi per avere esattamente 1 psicologo clinico nella commissione è:</p>
<p><span class="math display">\[
10C1 \times 10C4 = 10 \times 210 = 2,100 .
\]</span></p>
<p>Quindi, la probabilità di avere esattamente 1 psicologo clinico è <span class="math inline">\(\frac{2,100}{15,504} \approx 0.135\)</span>.</p>
<p>La probabilità di avere almeno 2 psicologi clinici nella commissione è quindi:</p>
<p><span class="math display">\[
P(\text{almeno 2 psicologi clinici nella commissione}) = 1 - 0.016 - 0.135 = 0.849 .
\]</span></p>
<div id="c8569833-cf06-44a2-8e9e-2e51abb368b5" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funzione per calcolare le combinazioni</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nCk(n, k):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> math.factorial(n) <span class="op">//</span> (math.factorial(k) <span class="op">*</span> math.factorial(n <span class="op">-</span> k))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcolo delle probabilità per il problema della commissione</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>total_ways <span class="op">=</span> nCk(<span class="dv">20</span>, <span class="dv">5</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>no_clinical <span class="op">=</span> nCk(<span class="dv">10</span>, <span class="dv">0</span>) <span class="op">*</span> nCk(<span class="dv">10</span>, <span class="dv">5</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>one_clinical <span class="op">=</span> nCk(<span class="dv">10</span>, <span class="dv">1</span>) <span class="op">*</span> nCk(<span class="dv">10</span>, <span class="dv">4</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>p_no_clinical <span class="op">=</span> no_clinical <span class="op">/</span> total_ways</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>p_one_clinical <span class="op">=</span> one_clinical <span class="op">/</span> total_ways</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>p_at_least_two_clinical <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> p_no_clinical <span class="op">-</span> p_one_clinical</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Probabilità di almeno 2 psicologi clinici: </span><span class="sc">{</span>p_at_least_two_clinical<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Probabilità di almeno 2 psicologi clinici: 0.848</code></pre>
</div>
</div>
</section>
<section id="esempio-problema-del-messaggio-di-schwarzenegger" class="level4" data-number="17.4.3.2">
<h4 data-number="17.4.3.2" class="anchored" data-anchor-id="esempio-problema-del-messaggio-di-schwarzenegger"><span class="header-section-number">17.4.3.2</span> Esempio: Problema del Messaggio di Schwarzenegger</h4>
<p>Consideriamo un incidente del 2009 quando il Governatore della California Arnold Schwarzenegger inviò un messaggio all’assemblea statale riguardo il veto al disegno di legge 1176. Questo messaggio formava un’acrostico volgare con le prime lettere di ogni riga.</p>
<div id="fig-arnold" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-arnold-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../figures/arnold.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-arnold-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17.1: Il Messaggio di Schwarzenegger.
</figcaption>
</figure>
</div>
<p>Qual è la probabilità che questo acrostico sia stato casuale?</p>
<p>Supponiamo che il messaggio sia stato diviso in 7 righe in modo casuale. Per ottenere 7 righe, devono essere inseriti 6 interruzioni di riga in 84 spazi possibili (prima della seconda parola, terza parola, ecc.). Il numero di modi per inserire 6 interruzioni in 84 spazi è dato da:</p>
<p><span class="math display">\[
84C6 = \frac{84!}{6!(78!)} \approx 406,481,544 .
\]</span></p>
<p>Tuttavia, ci sono solo 12 modi per produrre questo particolare acrostico. Quindi, la probabilità che questo acrostico si verifichi casualmente è:</p>
<p><span class="math display">\[
\frac{12}{84C6} \approx \frac{12}{406,481,544} \approx 1 \text{ su } 34,000,000 .
\]</span></p>
<div id="6c07dd53-7a19-4300-b87a-617db3334163" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcolo del numero di combinazioni</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>total_ways_acrostic <span class="op">=</span> nCk(<span class="dv">84</span>, <span class="dv">6</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>acrostic_ways <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>p_acrostic <span class="op">=</span> acrostic_ways <span class="op">/</span> total_ways_acrostic</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Probabilità dell'acrostico: </span><span class="sc">{</span>p_acrostic<span class="sc">:.2e}</span><span class="ss">"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Probabilità dell'acrostico: 2.95e-08</code></pre>
</div>
</div>
<p>Questa analisi suggerisce che, secondo questo modello probabilistico, la “coincidenza” è un evento altamente improbabile.</p>
</section>
</section>
</section>
<section id="commenti-e-considerazioni-finali" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="commenti-e-considerazioni-finali"><span class="header-section-number">17.5</span> Commenti e considerazioni finali</h2>
<p>In questo capitolo, abbiamo esplorato i fondamenti della teoria delle probabilità, tra cui la costruzione dello spazio campione per gli esperimenti casuali e le proprietà fondamentali della probabilità. Abbiamo imparato a calcolare le probabilità degli eventi in uno spazio campione discreto. Inoltre, abbiamo introdotto il concetto di simulazione come metodo per approssimare le distribuzioni di probabilità empiriche quando non è possibile ottenere soluzioni analitiche.</p>
<p>La teoria delle probabilità è essenziale per la statistica e ha diverse applicazioni pratiche, tra cui la psicologia. Comprendere le probabilità ci consente di prendere decisioni informate in situazioni incerte e di sviluppare previsioni affidabili. Con una solida comprensione delle nozioni di base della probabilità, possiamo affrontare una vasta gamma di problemi e prendere decisioni basate sulla probabilità dei risultati possibili. Tuttavia, è fondamentale ricordare che i modelli probabilistici sono solo approssimazioni della realtà e possono essere influenzati da semplificazioni e limitazioni dei dati disponibili. Pertanto, è importante esercitare cautela nell’interpretazione dei risultati e comprendere le assunzioni alla base delle analisi.</p>
</section>
<section id="informazioni-sullambiente-di-sviluppo" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="informazioni-sullambiente-di-sviluppo"><span class="header-section-number">17.6</span> Informazioni sull’Ambiente di Sviluppo</h2>
<div id="b0bc31c4-e841-4fef-b925-52dc7735b338" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext watermark</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>watermark <span class="op">-</span>n <span class="op">-</span>u <span class="op">-</span>v <span class="op">-</span>iv <span class="op">-</span>w <span class="op">-</span>m</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Last updated: Tue May 21 2024

Python implementation: CPython
Python version       : 3.12.3
IPython version      : 8.22.2

Compiler    : Clang 16.0.6 
OS          : Darwin
Release     : 23.4.0
Machine     : arm64
Processor   : arm
CPU cores   : 8
Architecture: 64bit

scipy     : 1.13.0
arviz     : 0.18.0
matplotlib: 3.8.4
pandas    : 2.2.2
seaborn   : 0.13.2
numpy     : 1.26.4

Watermark: 2.4.3
</code></pre>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-clayton2021bernoulli" class="csl-entry" role="listitem">
Clayton, Aubrey. 2021. <em>Bernoulli’s Fallacy: Statistical Illogic and the Crisis of Modern Science</em>. Columbia University Press.
</div>
<div id="ref-de2017theory" class="csl-entry" role="listitem">
De Finetti, Bruno. 2017. <em>Theory of probability: A critical introductory treatment</em>. Vol. 6. John Wiley &amp; Sons.
</div>
<div id="ref-fishburn1986axioms" class="csl-entry" role="listitem">
Fishburn, Peter C. 1986. <span>«The axioms of subjective probability»</span>. <em>Statistical Science</em> 1 (3): 335–45.
</div>
<div id="ref-howson2006scientific" class="csl-entry" role="listitem">
Howson, Colin, e Peter Urbach. 2006. <em>Scientific reasoning: the Bayesian approach</em>. Open Court Publishing.
</div>
<div id="ref-kaplan2023bayesian" class="csl-entry" role="listitem">
Kaplan, David. 2023. <em>Bayesian statistics for the social sciences</em>. Guilford Publications.
</div>
<div id="ref-lindley2013understanding" class="csl-entry" role="listitem">
Lindley, Dennis V. 2013. <em>Understanding uncertainty</em>. John Wiley &amp; Sons.
</div>
<div id="ref-press2009subjective" class="csl-entry" role="listitem">
Press, S James. 2009. <em>Subjective and objective Bayesian statistics: Principles, models, and applications</em>. John Wiley &amp; Sons.
</div>
<div id="ref-ramsey1926truth" class="csl-entry" role="listitem">
Ramsey, Frank P. 1926. <span>«Truth and probability»</span>. In <em>Readings in Formal Epistemology: Sourcebook</em>, 21–45. Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria\/intro\.html");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/chapter_2/06_causality.html" class="pagination-link" aria-label="Causalità dai dati osservazionali">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/chapter_3/02_conditional_prob.html" class="pagination-link" aria-label="Probabilità condizionata">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/ccaudek/psicometria/blob/main/chapters/chapter_3/01_intro_prob.ipynb" class="toc-action"><i class="bi bi-github"></i>Modifica questa pagina</a></li></ul></div></div></div></footer></body></html>